{"version":3,"file":"ItemMovement.plugin.js","sources":["../src/plugins/ItemMovement.plugin.ts"],"sourcesContent":["/**\n * ItemMovement plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   AGPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)\n * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar\n */\n\nexport interface Options {\n  moveable?: boolean | string;\n  resizeable?: boolean;\n  resizerContent?: string;\n  collisionDetection?: boolean;\n  outOfBorders?: boolean;\n  snapStart?: (timeStart: number, startDiff: number, item: object) => number;\n  snapEnd?: (timeEnd: number, endDiff: number, item: object) => number;\n  ghostNode?: boolean;\n  wait?: number;\n}\n\nexport interface Movement {\n  moving: boolean;\n  resizing: boolean;\n  waiting: boolean;\n  ghost?: HTMLElement;\n  itemLeftCompensation?: number;\n  itemTop?: number;\n  itemX?: number;\n  ganttTop?: number;\n  ganttLeft?: number;\n}\n\nconst pointerEventsExists = typeof PointerEvent !== 'undefined';\n\nexport default function ItemMovement(options: Options = {}) {\n  const defaultOptions = {\n    moveable: true,\n    resizeable: true,\n    resizerContent: '',\n    collisionDetection: true,\n    outOfBorders: false,\n    snapStart(timeStart, startDiff) {\n      return timeStart + startDiff;\n    },\n    snapEnd(timeEnd, endDiff) {\n      return timeEnd + endDiff;\n    },\n    ghostNode: true,\n    wait: 0\n  };\n  options = { ...defaultOptions, ...options };\n\n  const movementState = {};\n\n  /**\n   * Add moving functionality to items as action\n   *\n   * @param {HTMLElement} element DOM Node\n   * @param {Object} data\n   */\n  function ItemAction(element: HTMLElement, data) {\n    if (!options.moveable && !options.resizeable) {\n      return;\n    }\n    const state = data.state;\n    const api = data.api;\n\n    function isMoveable(data) {\n      let moveable = options.moveable;\n      if (data.item.hasOwnProperty('moveable') && moveable) {\n        moveable = data.item.moveable;\n      }\n      if (data.row.hasOwnProperty('moveable') && moveable) {\n        moveable = data.row.moveable;\n      }\n      return moveable;\n    }\n\n    function isResizeable(data) {\n      let resizeable = options.resizeable && (!data.item.hasOwnProperty('resizeable') || data.item.resizeable === true);\n      if (data.row.hasOwnProperty('resizeable') && resizeable) {\n        resizeable = data.row.resizeable;\n      }\n      return resizeable;\n    }\n\n    function getMovement(data) {\n      const itemId = data.item.id;\n      if (typeof movementState[itemId] === 'undefined') {\n        movementState[itemId] = { moving: false, resizing: false, waiting: false };\n      }\n      return movementState[itemId];\n    }\n\n    function saveMovement(itemId: string, movement: Movement) {\n      state.update(`config.plugin.ItemMovement.item`, { id: itemId, ...movement });\n      state.update('config.plugin.ItemMovement.movement', (current: Movement) => {\n        if (!current) {\n          current = { moving: false, waiting: false, resizing: false };\n        }\n        current.moving = movement.moving;\n        current.waiting = movement.waiting;\n        current.resizing = movement.resizing;\n        return current;\n      });\n    }\n\n    function createGhost(data, normalized, ganttLeft, ganttTop) {\n      const movement: Movement = getMovement(data);\n      if (!options.ghostNode || typeof movement.ghost !== 'undefined') {\n        return;\n      }\n      const ghost = element.cloneNode(true) as HTMLElement;\n      const style = getComputedStyle(element);\n      const compensationY = state.get('config.scroll.compensation.y');\n      ghost.style.position = 'absolute';\n      ghost.style.left = normalized.clientX - ganttLeft - movement.itemLeftCompensation + 'px';\n      const itemTop = normalized.clientY - ganttTop - element.offsetTop - compensationY + parseInt(style['margin-top']);\n      movement.itemTop = itemTop;\n      ghost.style.top = normalized.clientY - ganttTop - itemTop + 'px';\n      ghost.style.width = style.width;\n      ghost.style['box-shadow'] = '10px 10px 6px #00000020';\n      const height = element.clientHeight + 'px';\n      ghost.style.height = height;\n      ghost.style['line-height'] = element.clientHeight - 18 + 'px';\n      ghost.style.opacity = '0.6';\n      ghost.style.transform = 'scale(1.05, 1.05)';\n      state.get('_internal.elements.chart-timeline').appendChild(ghost);\n      movement.ghost = ghost;\n      saveMovement(data.item.id, movement);\n      return ghost;\n    }\n\n    function moveGhost(data, normalized) {\n      if (options.ghostNode) {\n        const movement = getMovement(data);\n        const left = normalized.clientX - movement.ganttLeft - movement.itemLeftCompensation;\n        movement.ghost.style.left = left + 'px';\n        movement.ghost.style.top =\n          normalized.clientY -\n          movement.ganttTop -\n          movement.itemTop +\n          parseInt(getComputedStyle(element)['margin-top']) +\n          'px';\n        saveMovement(data.item.id, movement);\n      }\n    }\n\n    function destroyGhost(itemId) {\n      if (!options.ghostNode) {\n        return;\n      }\n      if (typeof movementState[itemId] !== 'undefined' && typeof movementState[itemId].ghost !== 'undefined') {\n        state.get('_internal.elements.chart-timeline').removeChild(movementState[itemId].ghost);\n        delete movementState[itemId].ghost;\n        saveMovement(data.item.id, movementState[itemId]);\n      }\n    }\n\n    function getSnapStart(data) {\n      let snapStart = options.snapStart;\n      if (typeof data.item.snapStart === 'function') {\n        snapStart = data.item.snapStart;\n      }\n      return snapStart;\n    }\n\n    function getSnapEnd(data) {\n      let snapEnd = options.snapEnd;\n      if (typeof data.item.snapEnd === 'function') {\n        snapEnd = data.item.snapEnd;\n      }\n      return snapEnd;\n    }\n\n    const resizerHTML = `<div class=\"${api.getClass('chart-timeline-items-row-item-resizer')}\">${\n      options.resizerContent\n    }</div>`;\n    // @ts-ignore\n    element.insertAdjacentHTML('beforeend', resizerHTML);\n    const resizerEl: HTMLElement = element.querySelector(\n      '.gantt-schedule-timeline-calendar__chart-timeline-items-row-item-resizer'\n    );\n    if (!isResizeable(data)) {\n      resizerEl.style.visibility = 'hidden';\n    } else {\n      resizerEl.style.visibility = 'visible';\n    }\n\n    function labelDown(ev) {\n      const normalized = api.normalizePointerEvent(ev);\n      if ((ev.type === 'pointerdown' || ev.type === 'mousedown') && ev.button !== 0) {\n        return;\n      }\n      const movement: Movement = getMovement(data);\n      movement.waiting = true;\n      saveMovement(data.item.id, movement);\n      setTimeout(() => {\n        ev.stopPropagation();\n        ev.preventDefault();\n        if (!movement.waiting) return;\n        movement.moving = true;\n        const item = state.get(`config.chart.items.${data.item.id}`);\n        const chartLeftTime = state.get('_internal.chart.time.leftGlobal');\n        const timePerPixel = state.get('_internal.chart.time.timePerPixel');\n        const ganttRect = state.get('_internal.elements.chart-timeline').getBoundingClientRect();\n        movement.ganttTop = ganttRect.top;\n        movement.ganttLeft = ganttRect.left;\n        movement.itemX = Math.round((item.time.start - chartLeftTime) / timePerPixel);\n        movement.itemLeftCompensation = normalized.clientX - movement.ganttLeft - movement.itemX;\n        saveMovement(data.item.id, movement);\n        createGhost(data, normalized, ganttRect.left, ganttRect.top);\n      }, options.wait);\n    }\n\n    function resizerDown(ev) {\n      ev.stopPropagation();\n      ev.preventDefault();\n      if ((ev.type === 'pointerdown' || ev.type === 'mousedown') && ev.button !== 0) {\n        return;\n      }\n      const normalized = api.normalizePointerEvent(ev);\n      const movement = getMovement(data);\n      movement.resizing = true;\n      const item = state.get(`config.chart.items.${data.item.id}`);\n      const chartLeftTime = state.get('_internal.chart.time.leftGlobal');\n      const timePerPixel = state.get('_internal.chart.time.timePerPixel');\n      const ganttRect = state.get('_internal.elements.chart-timeline').getBoundingClientRect();\n      movement.ganttTop = ganttRect.top;\n      movement.ganttLeft = ganttRect.left;\n      movement.itemX = (item.time.end - chartLeftTime) / timePerPixel;\n      movement.itemLeftCompensation = normalized.clientX - movement.ganttLeft - movement.itemX;\n      saveMovement(data.item.id, movement);\n    }\n\n    function isCollision(rowId, itemId, start, end) {\n      if (!options.collisionDetection) {\n        return false;\n      }\n      const time = state.get('_internal.chart.time');\n      if (options.outOfBorders && (start < time.from || end > time.to)) {\n        return true;\n      }\n      let diff = api.time.date(end).diff(start, 'milliseconds');\n      if (Math.sign(diff) === -1) {\n        diff = -diff;\n      }\n      if (diff <= 1) {\n        return true;\n      }\n      const row = state.get('config.list.rows.' + rowId);\n      for (const rowItem of row._internal.items) {\n        if (rowItem.id !== itemId) {\n          if (start >= rowItem.time.start && start <= rowItem.time.end) {\n            return true;\n          }\n          if (end >= rowItem.time.start && end <= rowItem.time.end) {\n            return true;\n          }\n          if (start <= rowItem.time.start && end >= rowItem.time.end) {\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n\n    function movementX(normalized, row, item, zoom, timePerPixel) {\n      const movement = getMovement(data);\n      const left = normalized.clientX - movement.ganttLeft - movement.itemLeftCompensation;\n      moveGhost(data, normalized);\n      const leftMs = state.get('_internal.chart.time.leftGlobal') + left * timePerPixel;\n      const add = leftMs - item.time.start;\n      const originalStart = item.time.start;\n      const finalStartTime = getSnapStart(data)(item.time.start, add, item);\n      const finalAdd = finalStartTime - originalStart;\n      const collision = isCollision(row.id, item.id, item.time.start + finalAdd, item.time.end + finalAdd);\n      if (finalAdd && !collision) {\n        state.update(`config.chart.items.${data.item.id}.time`, function moveItem(time) {\n          time.start += finalAdd;\n          time.end = getSnapEnd(data)(time.end, finalAdd, item) - 1;\n          return time;\n        });\n      }\n    }\n\n    function resizeX(normalized, row, item, zoom, timePerPixel) {\n      if (!isResizeable(data)) {\n        return;\n      }\n      const time = state.get('_internal.chart.time');\n      const movement = getMovement(data);\n      const left = normalized.clientX - movement.ganttLeft - movement.itemLeftCompensation;\n      const leftMs = time.leftGlobal + left * timePerPixel;\n      const add = leftMs - item.time.end;\n      if (item.time.end + add < item.time.start) {\n        return;\n      }\n      const originalEnd = item.time.end;\n      const finalEndTime = getSnapEnd(data)(item.time.end, add, item) - 1;\n      const finalAdd = finalEndTime - originalEnd;\n      const collision = isCollision(row.id, item.id, item.time.start, item.time.end + finalAdd);\n      if (finalAdd && !collision) {\n        state.update(`config.chart.items.${data.item.id}.time`, time => {\n          time.start = getSnapStart(data)(time.start, 0, item);\n          time.end = getSnapEnd(data)(time.end, finalAdd, item) - 1;\n          return time;\n        });\n      }\n    }\n\n    function movementY(normalized, row, item, zoom, timePerPixel) {\n      moveGhost(data, normalized);\n      const movement = getMovement(data);\n      const top = normalized.clientY - movement.ganttTop;\n      const visibleRows = state.get('_internal.list.visibleRows');\n      const compensationY = state.get('config.scroll.compensation.y');\n      let index = 0;\n      for (const currentRow of visibleRows) {\n        if (currentRow.top + compensationY > top) {\n          if (index > 0) {\n            return index - 1;\n          }\n          return 0;\n        }\n        index++;\n      }\n      return index;\n    }\n\n    function documentMove(ev) {\n      const movement = getMovement(data);\n      const normalized = api.normalizePointerEvent(ev);\n      let item, rowId, row, zoom, timePerPixel;\n      if (movement.moving || movement.resizing) {\n        ev.stopPropagation();\n        ev.preventDefault();\n        item = state.get(`config.chart.items.${data.item.id}`);\n        rowId = state.get(`config.chart.items.${data.item.id}.rowId`);\n        row = state.get(`config.list.rows.${rowId}`);\n        zoom = state.get('config.chart.time.zoom');\n        timePerPixel = state.get('_internal.chart.time.timePerPixel');\n      }\n      const moveable = isMoveable(data);\n      if (movement.moving) {\n        if (moveable === true || moveable === 'x' || (Array.isArray(moveable) && moveable.includes(rowId))) {\n          movementX(normalized, row, item, zoom, timePerPixel);\n        }\n        if (!moveable || moveable === 'x') {\n          return;\n        }\n        let visibleRowsIndex = movementY(normalized, row, item, zoom, timePerPixel);\n        const visibleRows = state.get('_internal.list.visibleRows');\n        if (typeof visibleRows[visibleRowsIndex] === 'undefined') {\n          if (visibleRowsIndex > 0) {\n            visibleRowsIndex = visibleRows.length - 1;\n          } else if (visibleRowsIndex < 0) {\n            visibleRowsIndex = 0;\n          }\n        }\n        const newRow = visibleRows[visibleRowsIndex];\n        const newRowId = newRow.id;\n        const collision = isCollision(newRowId, item.id, item.time.start, item.time.end);\n        if (newRowId !== item.rowId && !collision) {\n          if (!Array.isArray(moveable) || moveable.includes(newRowId)) {\n            if (!newRow.hasOwnProperty('moveable') || newRow.moveable) {\n              state.update(`config.chart.items.${item.id}.rowId`, newRowId);\n            }\n          }\n        }\n      } else if (movement.resizing && (typeof item.resizeable === 'undefined' || item.resizeable === true)) {\n        resizeX(normalized, row, item, zoom, timePerPixel);\n      }\n    }\n\n    function documentUp(ev) {\n      const movement = getMovement(data);\n      if (movement.moving || movement.resizing || movement.waiting) {\n        ev.stopPropagation();\n        ev.preventDefault();\n      } else {\n        return;\n      }\n      movement.moving = false;\n      movement.waiting = false;\n      movement.resizing = false;\n      saveMovement(data.item.id, movement);\n      for (const itemId in movementState) {\n        movementState[itemId].moving = false;\n        movementState[itemId].resizing = false;\n        movementState[itemId].waiting = false;\n        destroyGhost(itemId);\n      }\n    }\n\n    if (pointerEventsExists) {\n      element.addEventListener('pointerdown', labelDown);\n      resizerEl.addEventListener('pointerdown', resizerDown);\n      document.addEventListener('pointermove', documentMove);\n      document.addEventListener('pointerup', documentUp);\n    } else {\n      element.addEventListener('touchstart', labelDown);\n      resizerEl.addEventListener('touchstart', resizerDown);\n      document.addEventListener('touchmove', documentMove);\n      document.addEventListener('touchend', documentUp);\n      document.addEventListener('touchcancel', documentUp);\n      element.addEventListener('mousedown', labelDown);\n      resizerEl.addEventListener('mousedown', resizerDown);\n      document.addEventListener('mousemove', documentMove);\n      document.addEventListener('mouseup', documentUp);\n    }\n\n    return {\n      update(node, changedData) {\n        if (!isResizeable(changedData) && resizerEl.style.visibility === 'visible') {\n          resizerEl.style.visibility = 'hidden';\n        } else if (isResizeable(changedData) && resizerEl.style.visibility === 'hidden') {\n          resizerEl.style.visibility = 'visible';\n        }\n        data = changedData;\n      },\n      destroy(node, data) {\n        if (pointerEventsExists) {\n          element.removeEventListener('pointerdown', labelDown);\n          resizerEl.removeEventListener('pointerdown', resizerDown);\n          document.removeEventListener('pointermove', documentMove);\n          document.removeEventListener('pointerup', documentUp);\n        } else {\n          element.removeEventListener('mousedown', labelDown);\n          resizerEl.removeEventListener('mousedown', resizerDown);\n          document.removeEventListener('mousemove', documentMove);\n          document.removeEventListener('mouseup', documentUp);\n          element.removeEventListener('touchstart', labelDown);\n          resizerEl.removeEventListener('touchstart', resizerDown);\n          document.removeEventListener('touchmove', documentMove);\n          document.removeEventListener('touchend', documentUp);\n          document.removeEventListener('touchcancel', documentUp);\n        }\n        resizerEl.remove();\n      }\n    };\n  }\n\n  return function initialize(vido) {\n    vido.state.update('config.actions.chart-timeline-items-row-item', actions => {\n      actions.push(ItemAction);\n      return actions;\n    });\n  };\n}\n"],"names":[],"mappings":"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"}